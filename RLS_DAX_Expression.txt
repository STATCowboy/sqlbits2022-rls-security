Path = PATH(SEC_ORG_USER_BASE[EMPLID],SEC_ORG_USER_BASE[MGRID])

Level 1 = PATHITEM(SEC_ORG_USER_BASE[Path],1)
Level 2 = PATHITEM(SEC_ORG_USER_BASE[Path],2)
Level 3 = PATHITEM(SEC_ORG_USER_BASE[Path],3)
Level 4 = PATHITEM(SEC_ORG_USER_BASE[Path],4)
Level 5 = PATHITEM(SEC_ORG_USER_BASE[Path],5)
Level 6 = PATHITEM(SEC_ORG_USER_BASE[Path],6)

Level 1 Name = LOOKUPVALUE(SEC_ORG_USER_BASE[NAME], SEC_ORG_USER_BASE[EMPLID], VALUE(PATHITEM(SEC_ORG_USER_BASE[Path],1)))
Level 2 Name = LOOKUPVALUE(SEC_ORG_USER_BASE[NAME], SEC_ORG_USER_BASE[EMPLID], VALUE(PATHITEM(SEC_ORG_USER_BASE[Path],2)))
Level 3 Name = LOOKUPVALUE(SEC_ORG_USER_BASE[NAME], SEC_ORG_USER_BASE[EMPLID], VALUE(PATHITEM(SEC_ORG_USER_BASE[Path],3)))
Level 4 Name = LOOKUPVALUE(SEC_ORG_USER_BASE[NAME], SEC_ORG_USER_BASE[EMPLID], VALUE(PATHITEM(SEC_ORG_USER_BASE[Path],4)))
Level 5 Name = LOOKUPVALUE(SEC_ORG_USER_BASE[NAME], SEC_ORG_USER_BASE[EMPLID], VALUE(PATHITEM(SEC_ORG_USER_BASE[Path],5)))
Level 6 Name = LOOKUPVALUE(SEC_ORG_USER_BASE[NAME], SEC_ORG_USER_BASE[EMPLID], VALUE(PATHITEM(SEC_ORG_USER_BASE[Path],6)))

HierarchyLevel = PATHLENGTH(PATH(SEC_ORG_USER_BASE[EMPLID], SEC_ORG_USER_BASE[MGRID]))
MaxNumLevels = MAX(SEC_ORG_USER_BASE[HierarchyLevel])

DAX RLS Expression:
-------------------
Org Security DAX = PATHCONTAINS(PATH(SEC_ORG_USER_BASE[EMPLID],SEC_ORG_USER_BASE[MGRID]),
                                 LOOKUPVALUE(SEC_ORG_USER_BASE[EMPLID], [USERID], 
                                     PATHITEM(SUBSTITUTE(USERPRINCIPALNAME(), "@", "|"), 1)))
									 
TWOUPMGRID = VALUE(PATHITEMREVERSE(PATH(SEC_ORG_USER_BASE[EMPLID],SEC_ORG_USER_BASE[MGRID]), 3))
THREEUPMGRID = VALUE(PATHITEMREVERSE(PATH(SEC_ORG_USER_BASE[EMPLID],SEC_ORG_USER_BASE[MGRID]), 4))
									 
1-Up Security DAX = PATHCONTAINS(PATH(SEC_ORG_USER_BASE[EMPLID],SEC_ORG_USER_BASE[MGRID]),
                                 LOOKUPVALUE(SEC_ORG_USER_BASE[MGRID], [USERID], 
                                     PATHITEM(SUBSTITUTE(USERPRINCIPALNAME(), "@", "|"), 1)))

2-Up Security DAX = PATHCONTAINS(PATH(SEC_ORG_USER_BASE[EMPLID],SEC_ORG_USER_BASE[MGRID]),
                                 LOOKUPVALUE(SEC_ORG_USER_BASE[TWOUPMGRID], [USERID], 
                                     PATHITEM(SUBSTITUTE(USERPRINCIPALNAME(), "@", "|"), 1)))
									 
3-Up Security DAX = PATHCONTAINS(PATH(SEC_ORG_USER_BASE[EMPLID],SEC_ORG_USER_BASE[MGRID]),
                                 LOOKUPVALUE(SEC_ORG_USER_BASE[THREEUPMGRID], [USERID], 
                                     PATHITEM(SUBSTITUTE(USERPRINCIPALNAME(), "@", "|"), 1)))
									 
-- 
									 
SecurityNode = LOOKUPVALUE(SEC_ASSET_MAP[OU],SEC_ASSET_MAP[OU],SEC_ORG_USER_BASE[ORG_UNIT_ID]) 
									 
SecurityNodeEmplID = LOOKUPVALUE(SEC_ORG_USER_BASE[EMPLID],SEC_ORG_USER_BASE[ORG_UNIT_ID], SEC_ORG_USER_BASE[SecurityNode])
									 
SecurityPath = IF(ISBLANK(SEC_ORG_USER_BASE[SecurityNodeEmplID]), 
                  IF(LOOKUPVALUE(SEC_ORG_USER_BASE[SecurityNodeEmplID],SEC_ORG_USER_BASE[SecurityNodeEmplID], SEC_ORG_USER_BASE[MGRID]), 
				     LOOKUPVALUE(SEC_ORG_USER_BASE[SecurityNodeEmplID],SEC_ORG_USER_BASE[SecurityNodeEmplID], SEC_ORG_USER_BASE[MGRID]),
					 IF(LOOKUPVALUE(SEC_ORG_USER_BASE[SecurityNodeEmplID],SEC_ORG_USER_BASE[SecurityNodeEmplID], SEC_ORG_USER_BASE[TWOUPMGRID]), 
				        LOOKUPVALUE(SEC_ORG_USER_BASE[SecurityNodeEmplID],SEC_ORG_USER_BASE[SecurityNodeEmplID], SEC_ORG_USER_BASE[TWOUPMGRID]),
					    IF(LOOKUPVALUE(SEC_ORG_USER_BASE[SecurityNodeEmplID],SEC_ORG_USER_BASE[SecurityNodeEmplID], SEC_ORG_USER_BASE[THREEUPMGRID]), 
				           LOOKUPVALUE(SEC_ORG_USER_BASE[SecurityNodeEmplID],SEC_ORG_USER_BASE[SecurityNodeEmplID], SEC_ORG_USER_BASE[THREEUPMGRID]),
					       0
						   )
						)
				    ),
				  SEC_ORG_USER_BASE[SecurityNodeEmplID])
				  
SecurityPathOU = LOOKUPVALUE(SEC_ORG_USER_BASE[ORG_UNIT_ID],SEC_ORG_USER_BASE[EMPLID],SEC_ORG_USER_BASE[SecurityPath]) 
					
					